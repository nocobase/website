このデモを迅速かつスムーズにあなた自身のNocoBase環境へ導入できるよう、2つの復元方法をご用意しました。お使いのユーザーバージョンと技術的背景に応じて、最適な方法をお選びください。

開始する前に、以下の点をご確認ください：

- 基本的なNocoBaseの実行環境がすでに構築されていること。メインシステムのインストールについては、より詳細な[公式インストールガイド](https://docs-cn.nocobase.com/welcome/getting-started/installation)（中国語）または[公式ドキュメント](https://docs.nocobase.com/welcome/getting-started/installation)（英語）をご参照ください。
- CRMデモの関連ファイルをダウンロード済みであること：
  - **バックアップファイル**（約21.2MB）：[crm\_demo\_20250711.nbdata](https://static-docs.nocobase.com/crm_demo_20250711.nbdata) - 方法1で使用
  - **SQLファイル**（圧縮後約9MB）：[crm\_demo\_20250711\_sql.zip](https://static-docs.nocobase.com/crm_demo_20250711_sql.zip) - 方法2で使用

**重要事項**：このデモは**PostgreSQL**データベースを基に作成されています。お使いの環境がPostgreSQLデータベースを使用していることをご確認ください。

---

### 方法1：バックアップマネージャーを使用した復元（Pro/Enterprise版ユーザー推奨）

この方法は、NocoBaseに組み込まれている「[バックアップマネージャー](https://docs-cn.nocobase.com/handbook/backups)」（Pro/Enterprise版）プラグインを通じてワンクリックで復元を行うため、操作が最も簡単です。ただし、環境とユーザーのバージョンに特定の要件があります。

#### 主な特徴

* **メリット**：
  1. **簡単な操作**：UI画面で完結し、プラグインを含むすべての設定を完全に復元できます。
  2. **完全な復元**：印刷テンプレートファイルやテーブル内のファイルフィールドにアップロードされたファイルなど、**すべてのシステムファイルを復元**でき、デモ機能の完全性を保証します。
* **デメリット**：
  1. **Pro/Enterprise版限定**：「バックアップマネージャー」はエンタープライズ向けのプラグインであり、Pro/Enterprise版のユーザーのみが利用できます。
  2. **厳格な環境要件**：お使いのデータベース環境（バージョン、大文字小文字の区別設定など）が、バックアップ作成時の環境と高い互換性を持つ必要があります。
  3. **プラグイン依存**：デモに含まれる商用プラグインがローカル環境にない場合、復元は失敗します。

#### 操作手順

**ステップ1：【強く推奨】`full`イメージを使用してアプリケーションを起動する**

データベースクライアントの不足による復元失敗を避けるため、`full`バージョンのDockerイメージを使用することを強くお勧めします。これには必要なすべてのサポートプログラムが組み込まれており、追加設定は不要です。（注意：このイメージは1.9.0-alpha.1で作成されています。バージョン互換性に注意してください）

イメージをプルするコマンド例：

```bash
docker pull nocobase/nocobase:1.9.0-alpha.3-full
```

その後、このイメージを使用してNocoBaseサービスを起動してください。

> **注**：`full`イメージを使用しない場合、コンテナ内で手動で`pg_dump`データベースクライアントをインストールする必要があり、そのプロセスは煩雑で不安定になる可能性があります。

**ステップ2：「バックアップマネージャー」プラグインを有効にする**

1. NocoBaseシステムにログインします。
2. **`プラグイン管理`** (Plugin Management) に移動します。
3. **`バックアップマネージャー`** (Backup Manager) プラグインを見つけて有効にします。

   ![20250711014113](https://static-docs.nocobase.com/20250711014113.png)

**ステップ3：ローカルバックアップファイルから復元する**

1. プラグインを有効にした後、ページを更新します。
2. 左側メニューの **`システム管理`** (System Management) -\> **`バックアップマネージャー`** (Backup Manager) に移動します。
3. 右上隅の **`ローカルバックアップから復元`** (Restore from Local Backup) ボタンをクリックします。

   ![20250711014216](https://static-docs.nocobase.com/20250711014216.png)
4. 提供されたデモのバックアップファイル（通常は`.zip`形式）をアップロードエリアにドラッグ＆ドロップします。
5. **`提出`** (Submit) をクリックし、システムが復元を完了するまでしばらく待ちます。このプロセスには数十秒から数分かかる場合があります。

   ![20250711014250](https://static-docs.nocobase.com/20250711014250.png)

#### ⚠️ 注意事項

* **データベースの互換性**：この方法で最も重要な点です。お使いのPostgreSQLデータベースの**バージョン、文字セット、大文字小文字の区別設定**が、デモのバックアップ元ファイルと一致している必要があります。特に、`schema`名は一致させる必要があります。
* **商用プラグインの一致**：デモが必要とするすべての商用プラグインを所有し、有効にしていることを確認してください。そうでない場合、復元は中断されます。

---

### 方法2：SQLファイルの直接インポート（共通、Community版向け）

この方法はデータベースを直接操作してデータを復元するため、「バックアップマネージャー」プラグインを回避し、Pro/Enterprise版プラグインの制限がありません。

#### 主な特徴

* **メリット**：
  1. **バージョン制限なし**：Community版を含むすべてのNocoBaseユーザーに適用可能です。
  2. **高い互換性**：アプリケーション内の`dump`ツールに依存せず、データベースに接続できれば操作可能です。
  3. **高いフォールトトレランス**：デモに未所有の商用プラグイン（例：EChartsグラフ）が含まれている場合、関連機能は有効になりませんが、他の機能の正常な使用には影響せず、アプリケーションは正常に起動します。
* **デメリット**：
  1. **データベース操作スキルが必要**：`.sql`ファイルの実行方法など、基本的なデータベース操作能力がユーザーに求められます。
  2. **⚠️ システムファイルの損失**：**この方法では、すべてのシステムファイルが失われます**。これには印刷テンプレートファイルや、テーブル内のファイルフィールドにアップロードされたファイルなどが含まれます。これは以下のことを意味します：
     - 印刷テンプレート機能が正常に動作しない可能性があります。
     - アップロード済みの画像やドキュメントなどのファイルが失われます。
     - ファイルフィールドに関連する機能が影響を受けます。

#### 操作手順

**ステップ1：クリーンなデータベースを準備する**

これからインポートするデモデータのために、新品で空のデータベースを準備します。

**ステップ2：`.sql`ファイルをデータベースにインポートする**

提供されたデモのデータベースファイル（通常は`.sql`形式）を取得し、その内容を前のステップで準備したデータベースにインポートします。実行方法は環境によって異なります：

* **選択肢A：サーバーのコマンドライン経由（Dockerを例に）**
  Dockerを使用してNocoBaseとデータベースをインストールした場合、`.sql`ファイルをサーバーにアップロードし、`docker exec`コマンドでインポートを実行できます。PostgreSQLコンテナ名が`my-nocobase-db`、ファイル名が`crm_demo.sql`の場合：

  ```bash
  # sqlファイルをコンテナ内にコピー
  docker cp crm_demo.sql my-nocobase-db:/tmp/
  # コンテナに入ってインポートコマンドを実行
  docker exec -it my-nocobase-db psql -U your_username -d your_database_name -f /tmp/crm_demo.sql
  ```
* **選択肢B：リモートデータベースクライアント経由**
  データベースがポートを公開している場合、任意のGUIデータベースクライアント（DBeaver, Navicat, pgAdminなど）を使用してデータベースに接続し、新しいクエリウィンドウを開き、`.sql`ファイルの全内容を貼り付けて実行します。

**ステップ3：データベースに接続し、アプリケーションを起動する**

NocoBaseの起動パラメータ（環境変数`DB_HOST`, `DB_PORT`, `DB_DATABASE`, `DB_USER`, `DB_PASSWORD`など）を設定し、データをインポートしたデータベースを指すようにします。その後、通常通りNocoBaseサービスを起動します。

![img_v3_02o3_eb637bd2-88c3-400b-8421-1ac2057d1aag](https://static-docs.nocobase.com/img_v3_02o3_eb637bd2-88c3-400b-8421-1ac2057d1aag.png)

#### ⚠️ 注意事項

* **データベース権限**：この方法では、データベースを直接操作できるアカウントとパスワードが必要です。
* **プラグインの状態**：インポート成功後、システムに含まれる商用プラグインのデータは存在しますが、ローカルで対応するプラグインをインストールして有効にしていない場合、関連機能（EChartsグラフ、特定のフィールドなど）は表示・使用できません。ただし、これによりアプリケーションがクラッシュすることはありません。

---

### まとめと比較


| 特徴                 | 方法1：バックアップマネージャー                                              | 方法2：SQL直接インポート                                                                                                                                                 |
| :------------------- | :--------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **対象ユーザー**     | **Pro/Enterprise版**ユーザー                                                 | **全ユーザー**（Community版を含む）                                                                                                                                      |
| **操作の容易さ**     | ⭐⭐⭐⭐⭐ (非常に簡単、UI操作)                                              | ⭐⭐⭐ (基本的なデータベース知識が必要)                                                                                                                                  |
| **環境要件**         | **厳格**。データベース、システムバージョンなどの高い互換性が必要             | **一般的**。データベースの互換性が必要                                                                                                                                   |
| **プラグイン依存度** | **強い依存**。不足しているプラグインがあると**復元が失敗**する。             | **機能はプラグインに強く依存**。データは独立してインポート可能で、システムは基本的な機能を備える。しかし、対応プラグインがない場合、関連機能は**全く使用できなくなる**。 |
| **システムファイル** | **✅ 完全に保持**（印刷テンプレート、アップロードファイル等）                | **❌ 損失する**（印刷テンプレート、アップロードファイル等）                                                                                                              |
| **推奨シナリオ**     | 環境が制御可能で一貫性があり、完全な機能デモが必要なエンタープライズユーザー | 一部のプラグインが不足しており、高い互換性と柔軟性を求めるユーザー、非Pro/Enterprise版ユーザー、ファイル機能の損失を許容できる場合                                       |

このチュートリアルが、CRMデモの導入に役立つことを願っています。操作中に問題が発生した場合は、いつでもお気軽にお問い合わせください！

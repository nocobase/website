Для стабильного прогресса в командной работе важно, чтобы каждый участник ясно понимал свою роль и уровень доступа. Сегодня мы разберёмся с созданием ролей и управлением правами, чтобы ваша команда работала слаженно и эффективно.

Не переживайте — этот процесс достаточно простой. Мы подробно проведём вас через все этапы, предоставляя подробное руководство. Если у вас возникнут проблемы, пожалуйста, обращайтесь на наш официальный форум за помощью.

### Анализ требований

Необходима роль "Партнер" с определенными правами доступа для участия в управлении задачами, но без возможности свободно изменять задачи других. Такой подход позволяет нам назначать задачи и гибко сотрудничать.

![Диаграмма структуры ролей](https://static-docs.nocobase.com/Solution/WSy8bi0zOozbBKxzlimcyje4n7f.png)

> **Введение в роли и права доступа:** Роли и права доступа — это основные механизмы для управления доступом пользователей и операциями. Каждый пользователь может иметь несколько ролей.
>
> Настраивая права доступа ролей, мы можем контролировать поведение пользователей и операции в системе, а также ограничивать отображаемый функционал, что крайне важно для контроля доступа.
>
> Использование ролей и прав доступа пользователей позволяет вам более эффективно управлять вашей системой. Как администратор, вы можете назначать и настраивать права доступа по мере необходимости.

### 6.1 **Создание и назначение ролей**

#### 6.1.1 **Создание роли «Партнер»**

- Нажмите на [**«Пользователи и права доступа»**](https://docs.nocobase.com/handbook/users) в правом верхнем углу интерфейса и выберите [**«Роли и права доступа»**](https://docs.nocobase.com/handbook/acl). 
- Нажмите кнопку **«Создать роль»**, и появится диалоговое окно. Здесь назовите роль **Партнер** и подтвердите сохранение.

![](https://static-docs.nocobase.com/Solution/demoE3v1-33.gif)

Вы успешно создали новую роль! Далее нам нужно назначить права доступа роли для участия в управлении задачами.

#### 6.1.2 **Назначение новой роли себе**

Чтобы убедиться, что права доступа роли работают должным образом, мы можем сначала назначить эту роль собственной учетной записи для тестирования. Это просто:

- В разделе управления пользователями найдите свою учетную запись, нажмите на нее, выберите **«Роли и права доступа»** и выберите **«Партнер»**.

![](https://static-docs.nocobase.com/Solution/demoE3v1-34.gif)

Теперь вы можете использовать свою учетную запись для имитации опыта роли "Партнер". Далее посмотрим, как переключать роли.

#### 6.1.3 **Переключение на роль «Партнер»**


- Нажмите на **Персональный центр** в правом верхнем углу, затем выберите **«Сменить роль»**.
- Вы можете заметить, что роль "Партнер" не появляется в списке сразу. Не волнуйтесь; просто **обновите страницу/очистите кеш**, и роль должна появиться.

![](https://static-docs.nocobase.com/Solution/demoE3v1-35.gif)

### 6.2 Назначение прав доступа к страницам для роли

После переключения на роль "Партнер" вы можете заметить, что нет видимых страниц или меню. Это потому, что мы еще не назначили права доступа для роли к конкретным страницам. Нет проблем — давайте настроим права доступа для роли "Партнер".

#### 6.2.1 **Назначение прав доступа к странице задач для роли «Партнер»**

- Сначала переключитесь обратно на роль **Root** (Супер-администратор) и перейдите на страницу **«Роли и права доступа»**.
- Нажмите на роль "Партнер", чтобы открыть страницу конфигурации. Здесь вы увидите вкладку **«Меню»**, которая представляет все страницы в системе.
- Установите флажок для права доступа к странице **«Управление задачами»**, чтобы разрешить роли "Партнер" доступ к странице управления задачами.

Вернитесь в **Персональный центр**, переключитесь обратно на роль "Партнер", и теперь вы должны видеть страницу меню управления задачами.

![](https://static-docs.nocobase.com/Solution/demoE3v1-36.gif)

#### 6.2.2 Настройка прав доступа к действиям и операциям с коллекциями

Хотя роль "Партнер" теперь имеет доступ к странице управления задачами, нам нужно дополнительно ограничить их операционные права доступа. Мы хотим, чтобы "Партнер" мог:

- **Просматривать и редактировать** задачи, назначенные на него,
- **Обновлять прогресс задач**,
- Но **не создавать или удалять задачи**.

Чтобы достичь этого, нам нужно настроить права доступа для коллекции "Задачи". Давайте продолжим!

##### 6.2.2.1 **Настройка прав доступа к действиям коллекции для роли «Партнер»**

- Перейдите на страницу **«Роли и права доступа»**, нажмите на роль "Партнер" и переключитесь на вкладку **«Источник данных»**.
- Здесь вы найдете настройки для "Прав доступа к действиям". Найдите **«Задачи»** и назначьте "Партнеру" права доступа «Просмотр» и «Редактирование».
- Мы не будем назначать права доступа «Добавление» или «Удаление» другим ролям, поэтому нет необходимости назначать их с самого начала.

![](https://static-docs.nocobase.com/Solution/demoE3v1-37.gif)

На этом этапе роль Партнер имеет права доступа на просмотр и редактирование данных задач. Далее нам нужен дополнительный контроль, чтобы гарантировать, что они могут редактировать только назначенные им задачи.

### 6.3 Добавление поля «Ответственное лицо» к задачам

Теперь мы назначим ответственное лицо для каждой задачи. Назначая ответственное лицо, мы гарантируем, что только ответственное лицо задачи может изменять задачу, в то время как другие могут только просматривать ее. Чтобы достичь этого, мы используем **поле связи**, чтобы связать коллекцию задач с коллекцией пользователей.

#### 6.3.1 **Создание поля «Ответственное лицо»**

1. Перейдите в **«Коллекцию задач»**, нажмите на **«Добавить поле»** и выберите **«Поле связи»**.
2. Выберите связь **«Многие-к-одному»** (поскольку каждая задача может иметь только одного ответственного, но пользователь может быть ответственным за несколько задач).
3. Назовите поле **«Ответственное лицо (Assignee)»**. Нет необходимости выбирать обратную связь сейчас.

![](https://static-docs.nocobase.com/Solution/511734242031202415135312.png)

#### 6.3.2 **Отображение поля «Ответственное лицо»**

Далее нам нужно убедиться, что поле "Ответственное лицо" отображается в коллекции и форме на странице управления задачами, чтобы было легко назначать ответственное лицо для каждой задачи. (Если поле по умолчанию отображается как ID, просто измените заголовок поля на «Имя» для отображения имен.)

![](https://static-docs.nocobase.com/Solution/181734242358202415135912.png)

### 6.4 **Управления пользователями и правами доступа** для контроля доступа

А вот и самое интересное! Теперь мы будем использовать [**Управление правами доступа**](https://docs-cn.nocobase.com/handbook/acl) NocoBase для реализации мощной функции: **только ответственное лицо и создатель задачи могут редактировать ее**, в то время как другие могут только просматривать. Именно здесь гибкость NocoBase действительно проявляется.

#### 6.4.1 **Простая проверка — только ответственное лицо может редактировать форму**

Мы хотим, чтобы только ответственное лицо задачи могло ее редактировать, поэтому мы установим следующие условия:

- Вернитесь к правам доступа к коллекциям данных для роли "Партнер", откройте конфигурацию для коллекции задач и нажмите на «Область данных» под правом доступа «Редактирование».
- Создайте пользовательское правило с названием «Ответственный может редактировать»:
  **Когда «Ответственное лицо/ID» равно «Текущий пользователь/ID»**, редактирование разрешено;
  Это означает, что только ответственное лицо задачи может редактировать ее, в то время как другие могут только просматривать.
- Поскольку мы используем коллекцию пользователей для поля ответственного лица, а вошедший в систему пользователь также находится в коллекции пользователей, это правило идеально соответствует нашему первоначальному требованию.

Нажмите «Добавить», затем «Подтвердить».

![](https://static-docs.nocobase.com/Solution/demoE3v1-38.gif)

Теперь вернемся на страницу для проверки:

Идеально! Когда мы переключаемся на роль Партнер и снова посещаем страницу, получается редактировать только задачи, в которых мы являемся ответственным лицом.

![](https://static-docs.nocobase.com/Solution/demoE3v1-39N.gif)

#### 6.4.2 **Добавление условий для модификации форм создателями**

Вы могли заметить новую проблему:

Поскольку мы не являемся ответственным лицом для большинства задач, мы не можем сами редактировать форму, и другие коллеги также не могут видеть детали задачи!

Не беспокойтесь — помните, ранее мы назначили роли Партнер **права на просмотр всех данных** ?

- Вернитесь к конфигурации страницы, выберите «Просмотр» и добавьте операцию просмотра.

![](https://static-docs.nocobase.com/Solution/081734249068202415155112.png)

- Аналогично диалогу прав доступа на редактирование, создайте диалог просмотра и обязательно выберите раздел «Детали».

![](https://static-docs.nocobase.com/Solution/181734249138202415155212.png)

![](https://static-docs.nocobase.com/Solution/081734249308202415155512.png)

Готово!

### 6.5 **Проверка контроля прав доступа**

Если вы переключаетесь между разными пользователями для просмотра формы, вы заметите, что разделы формы автоматически настраиваются, чтобы показывать только те операции, которые разрешены для каждого пользователя. 

Все задачи, за которые отвечает пользователь, будут отображать опции редактирования, в то время как задачи вне его ответственности будут показывать только опции просмотра.

Переключение обратно на роль Root восстанавливает полный доступ. Это мощная система контроля прав доступа NocoBase!

Далее вы можете свободно назначать ответственных за задачи, приглашать участников команды к сотрудничеству и тестировать установленные нами права.

#### 6.5.1 **Создание нового пользователя и назначение роли**

- Создайте нового пользователя, например, **Тома**, и назначьте ему роль **«Партнер»**.

![](https://static-docs.nocobase.com/Solution/571734249357202415155512.png)

![](https://static-docs.nocobase.com/Solution/221734249442202415155712.png)

- На странице управления задачами назначьте несколько задач **Тому**.

#### 6.5.2 **Тестирование входа**

Пусть Том войдет в систему, чтобы проверить, может ли он просматривать и редактировать назначенные ему задачи. Согласно правилам прав доступа, Том должен иметь возможность редактировать только задачи, за которые он отвечает, в то время как все остальные задачи доступны ему лишь для чтения.

Права доступа к форме редактирования теперь успешно синхронизированы на всех страницах!

![](https://static-docs.nocobase.com/Solution/demoE3v1-40N.gif)

### Резюме

Поздравляем! К настоящему моменту вы научились создавать роли, назначать права доступа и настраивать  доступ для пользователей в NocoBase, гарантируя, что члены команды могут редактировать только назначенные им задачи. Через эти шаги вы создали четкую, организованную систему управления правами доступа для командного сотрудничества.

### Задача-испытание

В настоящее время Том может просматривать и редактировать назначенные ему задачи, но вы можете заметить, что он **не может оставлять комментарии** или участвовать в обсуждениях задач. Как мы можем разрешить Тому свободно комментировать и участвовать в обсуждениях? Это интересная задача!

**Подсказка к задаче:**

Вы можете пересмотреть настройки прав доступа ролей и настроить роль "Партнер", в особенности настройки коллекции комментариев, гарантируя, что другие ограничения остаются в силе.

Попробуйте сделать это сами! А мы раскроем решение в следующем разделе.

В следующей главе мы реализуем функцию «Активность участников команды» и представим еще один мощный модуль: [**Рабочий процесс (Workflow)**](https://docs.nocobase.com/handbook/workflow). С помощью Рабочего процесса вы можете в фоновом режиме запускать различные действия и автоматизировать сложные бизнес-процессы в вашей системе. Готовы продолжить исследование? Увидимся в [Главе 7: Рабочий процесс](https://www.nocobase.com/en/blog/task-tutorial-workflow)

---

Продолжайте изучать возможности платформы и раскрывайте свой творческий потенциал! Если вы столкнулись с какими-либо проблемами, не забудьте проверить [Официальную документацию NocoBase](https://docs.nocobase.com/) или присоединиться к [Сообществу NocoBase](https://forum.nocobase.com/) для обсуждений.